# 主要交接内容

- 全景后装项目
  1. 代码框架解析
  2. 实车测试
  3. 艾拉比客户对接
  4. 标定算法集成
- 深圳算法组工作
  1. 车道线视频采集
  2. Di2L设备交接
  3. 日常工作管理

# 全景后装项目

## 代码框架解析

### 项目目录

![项目](./img/项目代码结构.png)

这里需要对CMakeList.txt文件做下详细说明：

1. 对cpp源代码的引入与头文件的加载

```cmake
file(GLOB sources ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/*.cpp
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/include/svm/*.cpp
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/component/*.cpp
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/subject/*.cpp
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/calibration/*.cpp
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/tools/*.cpp
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/factory/*.cpp
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/strategy/*.cpp
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/abstractview/*.cpp
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/include/nanovg/nanovg.c)
set(sample app)

add_library(${sample} SHARED ${sources})
target_link_libraries(${sample} log GLESv2 EGL)
set_target_properties(${sample} PROPERTIES LIBRARY_OUTPUT_NAME native)
target_include_directories(${sample} PUBLIC
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/include/
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/component/
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/subject/
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/calibration/
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/tools/
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/factory/
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/strategy/
        ${CMAKE_CURRENT_SOURCE_DIR}/src/main/cpp/abstractview/)
```

2.添加assimp

```cmake
# [Assimp Import Library]
add_library(assimp SHARED IMPORTED)
set_property(TARGET assimp PROPERTY IMPORTED_LOCATION ${CMAKE_CURRENT_SOURCE_DIR}/libs/${ANDROID_ABI}/libassimp.so)
target_link_libraries(${sample} assimp)
add_custom_command(TARGET ${sample} POST_BUILD COMMAND ${CMAKE_COMMAND} -E copy ${CMAKE_CURRENT_SOURCE_DIR}/libs/${ANDROID_ABI}/libassimp.so ${CMAKE_LIBRARY_OUTPUT_DIRECTORY})
# [Assimp Import Library]
```

3.添加opencv

```cmake
# [OpenCV Import Library]
add_library(opencv SHARED IMPORTED)
set_property(TARGET opencv PROPERTY IMPORTED_LOCATION ${CMAKE_CURRENT_SOURCE_DIR}/libs/${ANDROID_ABI}/libopencv_java4.so)
target_link_libraries(${sample} opencv)
add_custom_command(TARGET ${sample} POST_BUILD
        COMMAND ${CMAKE_COMMAND} -E copy ${CMAKE_CURRENT_SOURCE_DIR}/libs/${ANDROID_ABI}/libopencv_java4.so
        ${CMAKE_LIBRARY_OUTPUT_DIRECTORY})
# [OpenCV Import Library]
```

### Android端代码

#### 代码目录

![Android代码](./img/java.png)

这里面大部分是杨瑞泽写的，我把我写的部分单独挑出来说一下：

##### /common/AnnotationMacro.java

> 注释宏：定义了需要向Jni端传递的参数

| 关键字               | 示意                   |
| -------------------- | ---------------------- |
| ScreenMode           | 横竖屏模式             |
| DisplayMode          | 2D/3D模式              |
| TextureMode          | OES/PIC/VIDEO模式      |
| CameraView           | 单视图显示模式         |
| DoorIndex            | 车门索引（弃用）       |
| DoorStatus           | 车门状态（弃用）       |
| SingleView           | 单视图显示模式（弃用） |
| SettingMode          | 设置模式（弃用）       |
| OnDrawFrameMode      | jni渲染模式            |
| Gear                 | 档位                   |
| Board                | T7/8953模式            |
| CalibrationMode      | 标定模式               |
| CalibrationBoardType | 标定布模式             |
| CameraType           | 相机类型               |
| CalibrationRequest   | 标定请求               |
| LabelState           | 单视图显示图标状态     |

